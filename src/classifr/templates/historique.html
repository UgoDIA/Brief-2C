{% extends 'base.html' %}

{% load static %}


{% block content %}

<div id="test"  style="padding:50px" style="color:white">
    
<table class="table table-dark table-striped table-hover" style="color:white" id="table-container" ></table>
    
</div>

<script type="text/javascript">

    buildTable()

    function buildTable(){
        var test = document.getElementById(test)
        var url='http://127.0.0.1:8000/classifr/api/histo'
        var staticurl="{%static 'images/'%}"
        fetch(url)
        .then((resp)=>resp.json())
        .then(function(data){
            //console.log(data)
            let tableHtml = '<table><thead><tr><th>ID</th><th>Date</th><th>Image</th><th>Classe prédite</th><th>Precision</th><th>Correct Class</th><th>Model Name</th></tr></thead><tbody>';
                data.forEach(item => {
                    tableHtml += `<tr><td>${item.id_histo}</td><td>${item.date_pred}</td><td><img src=${staticurl}${item.nom_image} height="80" width="80"></td><td>${item.classe_predit} </td><td>${item.precision}%</td><td>${item.classe_correcte || '-'}</td><td>${item.nom_model}</td></tr>`;
                  });
                tableHtml += '</tbody></table>';
                document.getElementById('table-container').innerHTML = tableHtml; 
                $(document).ready( function () {
                    $('#table-container').DataTable({
                        order: [0,"desc"],
                        scrollY: "400px",
                        scrollCollapse: true,
                      
                       
                        "language": {
                            "lengthMenu": "Afficher _MENU_ lignes",
                            "info": "Affichage de _END_ lignes sur _TOTAL_ lignes",
                            "search": "Filtrer ",
                            "paginate": {
                                "next":       "Suivant",
                                "previous":   "Précédent"
                            },
                        }
                        
                    });
                } );
        })
           
    }   
    


</script>

{% endblock %}